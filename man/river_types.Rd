% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/river_types.R
\name{river_types}
\alias{river_types}
\title{Classify River Types using Regional Gaussian Mixture Models}
\usage{
river_types(
  all_data,
  core_regions,
  n_river_types = 1:9,
  membership_id,
  membership_cols = paste0("X", 1:3),
  non_value_cols = "ID"
)
}
\arguments{
\item{all_data}{An \code{sf} object or data frame containing the complete dataset
to be classified. Must contain the variables used in the core region models.}

\item{core_regions}{A list of \code{sf} objects or data frames. Each element represents
a distinct geographic or logical region used to train the classification models.}

\item{n_river_types}{Integer or integer vector. The number of mixture components
(clusters) to fit in \code{mclust::Mclust}. Default is \code{1:9}.}

\item{membership_id}{A matrix or data frame containing the fuzzy membership weights
of each observation in \code{all_data} relative to the \code{core_regions}.
Columns must correspond to the order of regions in \code{core_regions}.}

\item{membership_cols}{Character vector. Names of columns in \code{core_regions}
related to prior class membership that should be excluded from training.
Default is \code{paste0("X", 1:3)}.}

\item{non_value_cols}{Character vector. Names of identifier columns to be removed
before model training (e.g., primary keys). Default is \code{"ID"}.}
}
\value{
A list containing two elements:
\describe{
\item{\code{rivertypes}}{A matrix of weighted probabilities. Column names follow the format
"\eqn{Region{i}RiverType{k}}".}
\item{\code{models}}{A list of the fitted \code{mclust::Mclust} model objects for each region.}
}
}
\description{
This function trains Gaussian Mixture Models (GMM) on specified core regions and
projects these classifications onto a larger dataset. The final output weighs the
predicted cluster probabilities by the observation's membership to specific regions.
}
\details{
The function performs several preprocessing steps:
\itemize{
\item Geometry columns are dropped using \code{sf::st_drop_geometry}.
\item Constant variables within specific regions are identified and removed to avoid
singular covariance matrices during GMM fitting.
\item Specific logic is applied to geological variables (\code{area_sediment},
\code{area_calcareous}, \code{area_siliceous}). If two are constant, the third
is removed to prevent perfect collinearity (compositional data issues).
}

The prediction for a specific river type \eqn{k} in region \eqn{r} is calculated as:
\eqn{P(Type_k | Region_r) \times W_{r}}
Where \eqn{W_r} is the weight provided in \code{membership_id}.
}
